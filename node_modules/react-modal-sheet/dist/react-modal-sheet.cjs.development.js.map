{"version":3,"file":"react-modal-sheet.cjs.development.js","sources":["../src/constants.ts","../src/utils.ts","../src/hooks.tsx","../src/context.tsx","../src/use-prevent-scroll.ts","../src/styles.ts","../src/sheet.tsx","../src/SheetContainer.tsx","../src/SheetContent.tsx","../src/SheetHeader.tsx","../src/SheetBackdrop.tsx","../src/SheetScroller.tsx","../src/index.tsx"],"sourcesContent":["export const MAX_HEIGHT = 'calc(100% - env(safe-area-inset-top) - 34px)';\n\nexport const IS_SSR = typeof window === 'undefined';\n\nexport const DEFAULT_TWEEN_CONFIG = {\n  ease: 'easeOut',\n  duration: 0.2,\n};\n\nexport const REDUCED_MOTION_TWEEN_CONFIG = {\n  ease: 'linear',\n  duration: 0.01,\n};\n\nexport const DRAG_CLOSE_THRESHOLD = 0.6;\n\nexport const DRAG_VELOCITY_THRESHOLD = 500;\n","import * as React from 'react';\n\nexport function getClosest(nums: number[], goal: number) {\n  let closest = nums[0];\n  let minDifference = Math.abs(nums[0] - goal);\n\n  for (let i = 1; i < nums.length; i++) {\n    const difference = Math.abs(nums[i] - goal);\n    if (difference < minDifference) {\n      closest = nums[i];\n      minDifference = difference;\n    }\n  }\n\n  return closest;\n}\n\nexport function applyRootStyles(rootId: string) {\n  const body = document.querySelector('body') as HTMLBodyElement;\n  const root = document.querySelector(`#${rootId}`) as HTMLDivElement;\n\n  if (root) {\n    const p = 24;\n    const h = window.innerHeight;\n    const s = (h - p) / h;\n    body.style.backgroundColor = '#000';\n    root.style.overflow = 'hidden';\n    root.style.willChange = 'transform';\n    root.style.transition =\n      'transform 200ms ease-in-out, border-radius 200ms linear';\n    root.style.transform = `translateY(calc(env(safe-area-inset-top) + ${p / 2}px)) scale(${s})`; // prettier-ignore\n    root.style.borderTopRightRadius = '10px';\n    root.style.borderTopLeftRadius = '10px';\n  }\n}\n\nexport function cleanupRootStyles(rootId: string) {\n  const body = document.querySelector('body') as HTMLBodyElement;\n  const root = document.getElementById(rootId) as HTMLDivElement;\n\n  function onTransitionEnd() {\n    root.style.removeProperty('overflow');\n    root.style.removeProperty('will-change');\n    root.style.removeProperty('transition');\n    body.style.removeProperty('background-color');\n    root.removeEventListener('transitionend', onTransitionEnd);\n  }\n\n  if (root) {\n    // Start animating back\n    root.style.removeProperty('border-top-right-radius');\n    root.style.removeProperty('border-top-left-radius');\n    root.style.removeProperty('transform');\n\n    // Remove temp properties after animation is finished\n    root.addEventListener('transitionend', onTransitionEnd);\n  }\n}\n\nexport function inDescendingOrder(arr: number[]) {\n  for (let i = 0; i < arr.length; i++) {\n    if (arr[i + 1] > arr[i]) return false;\n  }\n\n  return true;\n}\n\nexport function validateSnapTo({\n  snapTo,\n  sheetHeight,\n}: {\n  snapTo: number;\n  sheetHeight: number;\n}) {\n  if (snapTo < 0) {\n    console.warn(\n      `Snap point is out of bounds. Sheet height is ${sheetHeight} but snap point is ${sheetHeight +\n        Math.abs(snapTo)}.`\n    );\n  }\n\n  return Math.max(Math.round(snapTo), 0);\n}\n\nexport function mergeRefs<T = any>(\n  refs: React.ForwardedRef<T>[]\n): React.RefCallback<T> {\n  return (value: any) => {\n    refs.forEach((ref: any) => {\n      if (typeof ref === 'function') {\n        ref(value);\n      } else if (ref) {\n        ref.current = value;\n      }\n    });\n  };\n}\n\nexport function isTouchDevice() {\n  if (typeof window === 'undefined') return false;\n  return 'ontouchstart' in window || navigator.maxTouchPoints > 0;\n}\n","import * as React from 'react';\n\nimport { IS_SSR } from './constants';\nimport { SheetEvents } from './types';\nimport { applyRootStyles, cleanupRootStyles } from './utils';\nimport { BoundingBox } from 'framer-motion';\n\nexport const useIsomorphicLayoutEffect = IS_SSR\n  ? React.useEffect\n  : React.useLayoutEffect;\n\nexport function useModalEffect(isOpen: boolean, rootId?: string) {\n  const prevOpen = usePrevious(isOpen);\n\n  // Automatically apply the iOS modal effect to the body when sheet opens/closes\n  React.useEffect(() => {\n    if (rootId && !prevOpen && isOpen) {\n      applyRootStyles(rootId);\n    } else if (rootId && !isOpen && prevOpen) {\n      cleanupRootStyles(rootId);\n    }\n  }, [isOpen, prevOpen]); // eslint-disable-line\n\n  // Make sure to cleanup modal styles on unmount\n  React.useEffect(() => {\n    return () => {\n      if (rootId && isOpen) cleanupRootStyles(rootId);\n    };\n  }, [isOpen]); // eslint-disable-line\n}\n\nexport function useEventCallbacks(\n  isOpen: boolean,\n  callbacks: React.MutableRefObject<SheetEvents>\n) {\n  const prevOpen = usePrevious(isOpen);\n  const didOpen = React.useRef(false);\n\n  // Because of AnimatePrecence we don't have access to latest isOpen value\n  // so we need to read and write to a ref to determine if we are\n  // opening or closing the sheet\n  const handleAnimationComplete = React.useCallback(() => {\n    if (!didOpen.current) {\n      callbacks.current.onOpenEnd?.();\n      didOpen.current = true;\n    } else {\n      callbacks.current.onCloseEnd?.();\n      didOpen.current = false;\n    }\n  }, [isOpen, prevOpen]); // eslint-disable-line\n\n  React.useEffect(() => {\n    if (!prevOpen && isOpen) {\n      callbacks.current.onOpenStart?.();\n    } else if (!isOpen && prevOpen) {\n      callbacks.current.onCloseStart?.();\n    }\n  }, [isOpen, prevOpen]); // eslint-disable-line\n\n  return { handleAnimationComplete };\n}\n\nexport function useWindowHeight() {\n  const [windowHeight, setWindowHeight] = React.useState(0);\n\n  useIsomorphicLayoutEffect(() => {\n    const updateHeight = () => setWindowHeight(window.innerHeight);\n    window.addEventListener('resize', updateHeight);\n    updateHeight();\n    return () => window.removeEventListener('resize', updateHeight);\n  }, []);\n\n  return windowHeight;\n}\n\nexport function usePrevious<T>(state: T): T | undefined {\n  const ref = React.useRef<T>();\n\n  React.useEffect(() => {\n    ref.current = state;\n  });\n\n  return ref.current;\n}\n\n// Userland version of the `useEvent` React hook:\n// RFC: https://github.com/reactjs/rfcs/blob/useevent/text/0000-useevent.md\nexport function useEvent<T extends (...args: any[]) => any>(handler: T) {\n  const handlerRef = React.useRef<T>();\n\n  useIsomorphicLayoutEffect(() => {\n    handlerRef.current = handler;\n  });\n\n  return React.useCallback((...args: any[]) => {\n    const fn = handlerRef.current;\n    return fn?.(...args);\n  }, []) as T;\n}\n\n// This is a hacky way to fix a bug in framer-motion where the drag\n// constraints are not updated when window is resized.\n// https://github.com/framer/motion/issues/1659\nconst constraints: BoundingBox = { bottom: 0, top: 0, left: 0, right: 0 };\n\nexport function useDragConstraints() {\n  const constraintsRef = React.useRef<any>(null);\n  const onMeasureDragConstraints = React.useCallback(() => constraints, []);\n  return { constraintsRef, onMeasureDragConstraints };\n}\n","import * as React from 'react';\nimport { SheetScrollerContextType, SheetContextType } from './types';\n\nexport const SheetContext = React.createContext<SheetContextType | undefined>(\n  undefined\n);\n\nexport const useSheetContext = () => {\n  const context = React.useContext(SheetContext);\n  if (!context) throw Error('Sheet context error');\n  return context;\n};\n\nexport const SheetScrollerContext = React.createContext<\n  SheetScrollerContextType | undefined\n>(undefined);\n\nexport function SheetScrollerContextProvider({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  const sheetContext = useSheetContext();\n  const [disableDrag, setDisableDrag] = React.useState(\n    !!sheetContext.disableDrag\n  );\n\n  function setDragEnabled() {\n    if (!sheetContext.disableDrag) setDisableDrag(false);\n  }\n\n  function setDragDisabled() {\n    if (!disableDrag) setDisableDrag(true);\n  }\n\n  return (\n    <SheetScrollerContext.Provider\n      value={{ disableDrag, setDragEnabled, setDragDisabled }}\n    >\n      {children}\n    </SheetScrollerContext.Provider>\n  );\n}\n\nexport const useSheetScrollerContext = () => {\n  const context = React.useContext(SheetScrollerContext);\n  if (!context) throw Error('Sheet scroller context error');\n  return context;\n};\n","// Source: https://github.com/adobe/react-spectrum/blob/main/packages/@react-aria/overlays/src/usePreventScroll.ts\nimport {\n  chain,\n  getScrollParent,\n  isIOS,\n  useLayoutEffect,\n} from '@react-aria/utils';\n\ninterface PreventScrollOptions {\n  /** Whether the scroll lock is disabled. */\n  isDisabled?: boolean;\n}\n\n// @ts-ignore\nconst visualViewport = typeof window !== 'undefined' && window.visualViewport;\n\n// HTML input types that do not cause the software keyboard to appear.\nconst nonTextInputTypes = new Set([\n  'checkbox',\n  'radio',\n  'range',\n  'color',\n  'file',\n  'image',\n  'button',\n  'submit',\n  'reset',\n]);\n\n// The number of active usePreventScroll calls. Used to determine whether to revert back to the original page style/scroll position\nlet preventScrollCount = 0;\nlet restore: any;\n\n/**\n * Prevents scrolling on the document body on mount, and\n * restores it on unmount. Also ensures that content does not\n * shift due to the scrollbars disappearing.\n */\nexport function usePreventScroll(options: PreventScrollOptions = {}) {\n  let { isDisabled } = options;\n\n  useLayoutEffect(() => {\n    if (isDisabled) {\n      return;\n    }\n\n    preventScrollCount++;\n    if (preventScrollCount === 1) {\n      if (isIOS()) {\n        restore = preventScrollMobileSafari();\n      } else {\n        restore = preventScrollStandard();\n      }\n    }\n\n    return () => {\n      preventScrollCount--;\n      if (preventScrollCount === 0) {\n        restore();\n      }\n    };\n  }, [isDisabled]);\n}\n\n// For most browsers, all we need to do is set `overflow: hidden` on the root element, and\n// add some padding to prevent the page from shifting when the scrollbar is hidden.\nfunction preventScrollStandard() {\n  return chain(\n    setStyle(\n      document.documentElement,\n      'paddingRight',\n      `${window.innerWidth - document.documentElement.clientWidth}px`\n    ),\n    setStyle(document.documentElement, 'overflow', 'hidden')\n  );\n}\n\n// Mobile Safari is a whole different beast. Even with overflow: hidden,\n// it still scrolls the page in many situations:\n//\n// 1. When the bottom toolbar and address bar are collapsed, page scrolling is always allowed.\n// 2. When the keyboard is visible, the viewport does not resize. Instead, the keyboard covers part of\n//    it, so it becomes scrollable.\n// 3. When tapping on an input, the page always scrolls so that the input is centered in the visual viewport.\n//    This may cause even fixed position elements to scroll off the screen.\n// 4. When using the next/previous buttons in the keyboard to navigate between inputs, the whole page always\n//    scrolls, even if the input is inside a nested scrollable element that could be scrolled instead.\n//\n// In order to work around these cases, and prevent scrolling without jankiness, we do a few things:\n//\n// 1. Prevent default on `touchmove` events that are not in a scrollable element. This prevents touch scrolling\n//    on the window.\n// 2. Prevent default on `touchmove` events inside a scrollable element when the scroll position is at the\n//    top or bottom. This avoids the whole page scrolling instead, but does prevent overscrolling.\n// 3. Prevent default on `touchend` events on input elements and handle focusing the element ourselves.\n// 4. When focusing an input, apply a transform to trick Safari into thinking the input is at the top\n//    of the page, which prevents it from scrolling the page. After the input is focused, scroll the element\n//    into view ourselves, without scrolling the whole page.\n// 5. Offset the body by the scroll position using a negative margin and scroll to the top. This should appear the\n//    same visually, but makes the actual scroll position always zero. This is required to make all of the\n//    above work or Safari will still try to scroll the page when focusing an input.\n// 6. As a last resort, handle window scroll events, and scroll back to the top. This can happen when attempting\n//    to navigate to an input with the next/previous buttons that's outside a modal.\nfunction preventScrollMobileSafari() {\n  let scrollable: Element | undefined;\n  let lastY = 0;\n  let onTouchStart = (e: TouchEvent) => {\n    // Store the nearest scrollable parent element from the element that the user touched.\n    scrollable = getScrollParent(e.target as Element);\n    if (\n      scrollable === document.documentElement &&\n      scrollable === document.body\n    ) {\n      return;\n    }\n\n    lastY = e.changedTouches[0].pageY;\n  };\n\n  let onTouchMove = (e: TouchEvent) => {\n    // In special situations, `onTouchStart` may be called without `onTouchStart` being called.\n    // (e.g. when the user places a finger on the screen before the <Sheet> is mounted and then moves the finger after it is mounted).\n    // If `onTouchStart` is not called, `scrollable` is `undefined`. Therefore, such cases are ignored.\n    if (scrollable === undefined) {\n      return;\n    }\n\n    // Prevent scrolling the window.\n    if (\n      scrollable === document.documentElement ||\n      scrollable === document.body\n    ) {\n      e.preventDefault();\n      return;\n    }\n\n    // Prevent scrolling up when at the top and scrolling down when at the bottom\n    // of a nested scrollable area, otherwise mobile Safari will start scrolling\n    // the window instead. Unfortunately, this disables bounce scrolling when at\n    // the top but it's the best we can do.\n    let y = e.changedTouches[0].pageY;\n    let scrollTop = scrollable.scrollTop;\n    let bottom = scrollable.scrollHeight - scrollable.clientHeight;\n\n    // Fix for: https://github.com/adobe/react-spectrum/pull/3780/files\n    if (bottom === 0) {\n      return;\n    }\n\n    if ((scrollTop <= 0 && y > lastY) || (scrollTop >= bottom && y < lastY)) {\n      e.preventDefault();\n    }\n\n    lastY = y;\n  };\n\n  let onTouchEnd = (e: TouchEvent) => {\n    let target = e.target as HTMLElement;\n\n    // Apply this change if we're not already focused on the target element\n    if (willOpenKeyboard(target) && target !== document.activeElement) {\n      e.preventDefault();\n\n      // Apply a transform to trick Safari into thinking the input is at the top of the page\n      // so it doesn't try to scroll it into view. When tapping on an input, this needs to\n      // be done before the \"focus\" event, so we have to focus the element ourselves.\n      target.style.transform = 'translateY(-2000px)';\n      target.focus();\n      requestAnimationFrame(() => {\n        target.style.transform = '';\n      });\n    }\n  };\n\n  let onFocus = (e: FocusEvent) => {\n    let target = e.target as HTMLElement;\n    if (willOpenKeyboard(target)) {\n      // Transform also needs to be applied in the focus event in cases where focus moves\n      // other than tapping on an input directly, e.g. the next/previous buttons in the\n      // software keyboard. In these cases, it seems applying the transform in the focus event\n      // is good enough, whereas when tapping an input, it must be done before the focus event. ðŸ¤·â€â™‚ï¸\n      target.style.transform = 'translateY(-2000px)';\n      requestAnimationFrame(() => {\n        target.style.transform = '';\n\n        // This will have prevented the browser from scrolling the focused element into view,\n        // so we need to do this ourselves in a way that doesn't cause the whole page to scroll.\n        if (visualViewport) {\n          if (visualViewport.height < window.innerHeight) {\n            // If the keyboard is already visible, do this after one additional frame\n            // to wait for the transform to be removed.\n            requestAnimationFrame(() => {\n              scrollIntoView(target);\n            });\n          } else {\n            // Otherwise, wait for the visual viewport to resize before scrolling so we can\n            // measure the correct position to scroll to.\n            visualViewport.addEventListener(\n              'resize',\n              () => scrollIntoView(target),\n              { once: true }\n            );\n          }\n        }\n      });\n    }\n  };\n\n  let onWindowScroll = () => {\n    // Last resort. If the window scrolled, scroll it back to the top.\n    // It should always be at the top because the body will have a negative margin (see below).\n    window.scrollTo(0, 0);\n  };\n\n  // Record the original scroll position so we can restore it.\n  // Then apply a negative margin to the body to offset it by the scroll position. This will\n  // enable us to scroll the window to the top, which is required for the rest of this to work.\n  let scrollX = window.pageXOffset;\n  let scrollY = window.pageYOffset;\n\n  let restoreStyles = chain(\n    setStyle(\n      document.documentElement,\n      'paddingRight',\n      `${window.innerWidth - document.documentElement.clientWidth}px`\n    ),\n    setStyle(document.documentElement, 'overflow', 'hidden'),\n    setStyle(document.body, 'marginTop', `-${scrollY}px`)\n  );\n\n  // Scroll to the top. The negative margin on the body will make this appear the same.\n  window.scrollTo(0, 0);\n\n  let removeEvents = chain(\n    addEvent(document, 'touchstart', onTouchStart, {\n      passive: false,\n      capture: true,\n    }),\n    addEvent(document, 'touchmove', onTouchMove, {\n      passive: false,\n      capture: true,\n    }),\n    addEvent(document, 'touchend', onTouchEnd, {\n      passive: false,\n      capture: true,\n    }),\n    addEvent(document, 'focus', onFocus, true),\n    addEvent(window, 'scroll', onWindowScroll)\n  );\n\n  return () => {\n    // Restore styles and scroll the page back to where it was.\n    restoreStyles();\n    removeEvents();\n    window.scrollTo(scrollX, scrollY);\n  };\n}\n\n// Sets a CSS property on an element, and returns a function to revert it to the previous value.\nfunction setStyle(element: any, style: string, value: string) {\n  let cur = element.style[style];\n  element.style[style] = value;\n\n  return () => {\n    element.style[style] = cur;\n  };\n}\n\n// Adds an event listener to an element, and returns a function to remove it.\nfunction addEvent<K extends keyof GlobalEventHandlersEventMap>(\n  target: EventTarget,\n  event: K,\n  handler: (this: Document, ev: GlobalEventHandlersEventMap[K]) => any,\n  options?: boolean | AddEventListenerOptions\n) {\n  target.addEventListener(event, handler as any, options);\n  return () => {\n    target.removeEventListener(event, handler as any, options);\n  };\n}\n\nfunction scrollIntoView(target: Element) {\n  let root = document.scrollingElement || document.documentElement;\n  while (target && target !== root) {\n    // Find the parent scrollable element and adjust the scroll position if the target is not already in view.\n    let scrollable = getScrollParent(target);\n    if (\n      scrollable !== document.documentElement &&\n      scrollable !== document.body &&\n      scrollable !== target\n    ) {\n      let scrollableTop = scrollable.getBoundingClientRect().top;\n      let targetTop = target.getBoundingClientRect().top;\n      if (targetTop > scrollableTop + target.clientHeight) {\n        scrollable.scrollTop += targetTop - scrollableTop;\n      }\n    }\n\n    target = scrollable.parentElement as any;\n  }\n}\n\nfunction willOpenKeyboard(target: Element) {\n  return (\n    (target instanceof HTMLInputElement &&\n      !nonTextInputTypes.has(target.type)) ||\n    target instanceof HTMLTextAreaElement ||\n    (target instanceof HTMLElement && target.isContentEditable)\n  );\n}\n","import * as CSS from 'csstype';\n\nconst styles: { [key: string]: CSS.Properties } = {\n  wrapper: {\n    position: 'fixed',\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    overflow: 'hidden',\n    pointerEvents: 'none',\n  },\n  backdrop: {\n    zIndex: 1,\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    backgroundColor: 'rgba(0, 0, 0, 0.2)',\n    touchAction: 'none', // Disable iOS body scrolling\n    border: 'none',\n  },\n  container: {\n    zIndex: 2,\n    position: 'absolute',\n    left: 0,\n    bottom: 0,\n    width: '100%',\n    backgroundColor: '#fff',\n    borderTopRightRadius: '8px',\n    borderTopLeftRadius: '8px',\n    boxShadow: '0px -2px 16px rgba(0, 0, 0, 0.3)',\n    display: 'flex',\n    flexDirection: 'column',\n    pointerEvents: 'auto',\n  },\n  headerWrapper: {\n    width: '100%',\n  },\n  header: {\n    height: '40px',\n    width: '100%',\n    position: 'relative',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  indicator: {\n    width: '18px',\n    height: '4px',\n    borderRadius: '99px',\n    backgroundColor: '#ddd',\n  },\n  content: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    minHeight: '0px',\n    position: 'relative',\n  },\n  scroller: {\n    height: '100%',\n    overflowY: 'auto',\n  },\n};\n\nexport default styles;\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\n\nimport {\n  animate,\n  AnimatePresence,\n  motion,\n  PanInfo,\n  Transition,\n  useMotionValue,\n  useReducedMotion,\n  useTransform,\n} from 'framer-motion';\n\nimport {\n  useModalEffect,\n  useWindowHeight,\n  useIsomorphicLayoutEffect,\n  useEvent,\n} from './hooks';\n\nimport {\n  REDUCED_MOTION_TWEEN_CONFIG,\n  DEFAULT_TWEEN_CONFIG,\n  DRAG_CLOSE_THRESHOLD,\n  DRAG_VELOCITY_THRESHOLD,\n  IS_SSR,\n} from './constants';\n\nimport { SheetContextType, SheetProps } from './types';\nimport { SheetScrollerContextProvider, SheetContext } from './context';\nimport { getClosest, inDescendingOrder, validateSnapTo } from './utils';\nimport { usePreventScroll } from './use-prevent-scroll';\nimport styles from './styles';\n\nconst Sheet = React.forwardRef<any, SheetProps>(\n  (\n    {\n      onOpenStart,\n      onOpenEnd,\n      onClose,\n      onCloseStart,\n      onCloseEnd,\n      onSnap,\n      children,\n      disableScrollLocking = false,\n      isOpen,\n      snapPoints,\n      rootId,\n      mountPoint,\n      style,\n      detent = 'full-height',\n      initialSnap = 0,\n      disableDrag = false,\n      prefersReducedMotion = false,\n      tweenConfig = DEFAULT_TWEEN_CONFIG,\n      ...rest\n    },\n    ref\n  ) => {\n    const sheetRef = React.useRef<any>(null);\n    const indicatorRotation = useMotionValue(0);\n    const windowHeight = useWindowHeight();\n    const shouldReduceMotion = useReducedMotion();\n    const reduceMotion = Boolean(prefersReducedMotion || shouldReduceMotion);\n    const animationOptions: Transition = {\n      type: 'tween',\n      ...(reduceMotion ? REDUCED_MOTION_TWEEN_CONFIG : tweenConfig),\n    };\n\n    // NOTE: the inital value for `y` doesn't matter since it is overwritten by\n    // the value driven by the `AnimatePresence` component when the sheet is opened\n    // and after that it is driven by the gestures and/or snapping\n    const y = useMotionValue(0);\n\n    const zIndex = useTransform(y, value =>\n      value >= windowHeight ? -1 : 9999999\n    );\n\n    const visibility = useTransform(y, value =>\n      value >= windowHeight ? 'hidden' : 'visible'\n    );\n\n    // Keep the callback fns up-to-date so that they can be accessed inside\n    // the effect without including them to the dependencies array\n    const callbacks = React.useRef({\n      onOpenStart,\n      onOpenEnd,\n      onCloseStart,\n      onCloseEnd,\n    });\n\n    useIsomorphicLayoutEffect(() => {\n      callbacks.current = {\n        onOpenStart,\n        onOpenEnd,\n        onCloseStart,\n        onCloseEnd,\n      };\n    });\n\n    if (snapPoints) {\n      // Convert negative / percentage snap points to absolute values\n      snapPoints = snapPoints.map(point => {\n        // Percentage values e.g. between 0.0 and 1.0\n        if (point > 0 && point <= 1) return Math.round(point * windowHeight);\n        return point < 0 ? windowHeight + point : point; // negative values\n      });\n\n      console.assert(\n        inDescendingOrder(snapPoints) || windowHeight === 0,\n        `Snap points need to be in descending order got: [${snapPoints}]`\n      );\n    }\n\n    const onDrag = useEvent((_, { delta }: PanInfo) => {\n      // Update drag indicator rotation based on drag velocity\n      const velocity = y.getVelocity();\n\n      if (velocity > 0) indicatorRotation.set(10);\n      if (velocity < 0) indicatorRotation.set(-10);\n\n      // Make sure user cannot drag beyond the top of the sheet\n      y.set(Math.max(y.get() + delta.y, 0));\n    });\n\n    const onDragEnd = useEvent((_, { velocity }: PanInfo) => {\n      if (velocity.y > DRAG_VELOCITY_THRESHOLD) {\n        // User flicked the sheet down\n        onClose();\n      } else {\n        const sheetEl = sheetRef.current as HTMLDivElement;\n        const sheetHeight = sheetEl.getBoundingClientRect().height;\n        const currentY = y.get();\n\n        let snapTo = 0;\n\n        if (snapPoints) {\n          const snapToValues = snapPoints.map(\n            p => sheetHeight - Math.min(p, sheetHeight)\n          );\n\n          // Allow snapping to the top of the sheet if detent is set to `content-height`\n          if (detent === 'content-height' && !snapToValues.includes(0)) {\n            snapToValues.unshift(0);\n          }\n\n          // Get the closest snap point\n          snapTo = getClosest(snapToValues, currentY);\n        } else if (currentY / sheetHeight > DRAG_CLOSE_THRESHOLD) {\n          // Close if dragged over enough far\n          snapTo = sheetHeight;\n        }\n\n        snapTo = validateSnapTo({ snapTo, sheetHeight });\n\n        // Update the spring value so that the sheet is animated to the snap point\n        animate(y, snapTo, animationOptions);\n\n        if (snapPoints && onSnap) {\n          const snapValue = Math.abs(Math.round(snapPoints[0] - snapTo));\n          const snapIndex = snapPoints.indexOf(getClosest(snapPoints, snapValue)); // prettier-ignore\n          onSnap(snapIndex);\n        }\n\n        const roundedSheetHeight = Math.round(sheetHeight);\n        const shouldClose = snapTo >= roundedSheetHeight;\n\n        if (shouldClose) onClose();\n      }\n\n      // Reset indicator rotation after dragging\n      indicatorRotation.set(0);\n    });\n\n    // Trigger onSnap callback when sheet is opened or closed\n    React.useEffect(() => {\n      if (!snapPoints || !onSnap) return;\n      const snapIndex = isOpen ? initialSnap : snapPoints.length - 1;\n      onSnap(snapIndex);\n    }, [isOpen]); // eslint-disable-line\n\n    React.useImperativeHandle(ref, () => ({\n      y,\n      snapTo: (snapIndex: number) => {\n        const sheetEl = sheetRef.current as HTMLDivElement | null;\n\n        if (\n          snapPoints &&\n          snapPoints[snapIndex] !== undefined &&\n          sheetEl !== null\n        ) {\n          const sheetHeight = sheetEl.getBoundingClientRect().height;\n          const snapPoint = snapPoints[snapIndex];\n          const snapTo = validateSnapTo({\n            snapTo: sheetHeight - snapPoint,\n            sheetHeight,\n          });\n\n          animate(y, snapTo, animationOptions);\n          if (onSnap) onSnap(snapIndex);\n          if (snapTo >= sheetHeight) onClose();\n        }\n      },\n    }));\n\n    useModalEffect(isOpen, rootId);\n\n    // Framer Motion should handle body scroll locking but it's not working\n    // properly on iOS. Scroll locking from React Aria seems to work much better.\n    usePreventScroll({ isDisabled: disableScrollLocking === true || !isOpen });\n\n    const dragProps = React.useMemo(() => {\n      const dragProps: SheetContextType['dragProps'] = {\n        drag: 'y',\n        dragElastic: 0,\n        dragMomentum: false,\n        dragPropagation: false,\n        onDrag,\n        onDragEnd,\n      };\n\n      return disableDrag ? undefined : dragProps;\n    }, [disableDrag]); // eslint-disable-line\n\n    const context: SheetContextType = {\n      y,\n      sheetRef,\n      isOpen,\n      initialSnap,\n      snapPoints,\n      detent,\n      indicatorRotation,\n      callbacks,\n      dragProps,\n      windowHeight,\n      animationOptions,\n      reduceMotion,\n      disableDrag,\n    };\n\n    const sheet = (\n      <SheetContext.Provider value={context}>\n        <motion.div\n          {...rest}\n          ref={ref}\n          style={{ ...styles.wrapper, zIndex, visibility, ...style }}\n        >\n          <AnimatePresence>\n            {/* NOTE: AnimatePresence requires us to set keys to children */}\n            {isOpen ? (\n              <SheetScrollerContextProvider>\n                {React.Children.map(children, (child: any, i) =>\n                  React.cloneElement(child, { key: `sheet-child-${i}` })\n                )}\n              </SheetScrollerContextProvider>\n            ) : null}\n          </AnimatePresence>\n        </motion.div>\n      </SheetContext.Provider>\n    );\n\n    if (IS_SSR) return sheet;\n\n    return ReactDOM.createPortal(sheet, mountPoint ?? document.body);\n  }\n);\n\nexport default Sheet;\n","import * as React from 'react';\nimport { motion } from 'framer-motion';\n\nimport { SheetContainerProps } from './types';\nimport { useSheetContext } from './context';\nimport { useEventCallbacks } from './hooks';\nimport { MAX_HEIGHT } from './constants';\nimport { mergeRefs } from './utils';\nimport styles from './styles';\n\nconst SheetContainer = React.forwardRef<any, SheetContainerProps>(\n  ({ children, style = {}, className = '', ...rest }, ref) => {\n    const {\n      y,\n      isOpen,\n      callbacks,\n      snapPoints,\n      initialSnap = 0,\n      sheetRef,\n      windowHeight,\n      detent,\n      animationOptions,\n      reduceMotion,\n    } = useSheetContext();\n\n    const { handleAnimationComplete } = useEventCallbacks(isOpen, callbacks);\n    const initialY = snapPoints ? snapPoints[0] - snapPoints[initialSnap] : 0;\n    const maxSnapHeight = snapPoints ? snapPoints[0] : null;\n\n    const height =\n      maxSnapHeight !== null\n        ? `min(${maxSnapHeight}px, ${MAX_HEIGHT})`\n        : MAX_HEIGHT;\n\n    return (\n      <motion.div\n        {...rest}\n        ref={mergeRefs([sheetRef, ref])}\n        className={`react-modal-sheet-container ${className}`}\n        style={{\n          ...styles.container,\n          ...style,\n          ...(detent === 'full-height' && { height }),\n          ...(detent === 'content-height' && { maxHeight: height }),\n          y,\n        }}\n        initial={reduceMotion ? false : { y: windowHeight }}\n        animate={{ y: initialY, transition: animationOptions }}\n        exit={{ y: windowHeight, transition: animationOptions }}\n        onAnimationComplete={handleAnimationComplete}\n      >\n        {children}\n      </motion.div>\n    );\n  }\n);\n\nexport default SheetContainer;\n","import * as React from 'react';\nimport { motion } from 'framer-motion';\n\nimport { SheetDraggableProps } from './types';\nimport { useSheetScrollerContext, useSheetContext } from './context';\nimport { useDragConstraints } from './hooks';\nimport { mergeRefs } from './utils';\nimport styles from './styles';\n\nconst SheetContent = React.forwardRef<any, SheetDraggableProps>(\n  ({ children, style, disableDrag, className = '', ...rest }, ref) => {\n    const sheetContext = useSheetContext();\n    const sheetScrollerContext = useSheetScrollerContext();\n    const { constraintsRef, onMeasureDragConstraints } = useDragConstraints();\n\n    const dragProps =\n      disableDrag || sheetScrollerContext.disableDrag\n        ? undefined\n        : sheetContext.dragProps;\n\n    return (\n      <motion.div\n        {...rest}\n        ref={mergeRefs([ref, constraintsRef])}\n        className={`react-modal-sheet-content ${className}`}\n        style={{ ...styles.content, ...style }}\n        {...dragProps}\n        dragConstraints={constraintsRef}\n        onMeasureDragConstraints={onMeasureDragConstraints}\n      >\n        {children}\n      </motion.div>\n    );\n  }\n);\n\nexport default SheetContent;\n","import * as React from 'react';\nimport { motion, useTransform } from 'framer-motion';\n\nimport { SheetDraggableProps } from './types';\nimport { useSheetContext } from './context';\nimport { useDragConstraints } from './hooks';\nimport { mergeRefs } from './utils';\nimport styles from './styles';\n\nconst SheetHeader = React.forwardRef<any, SheetDraggableProps>(\n  ({ children, style, disableDrag, ...rest }, ref) => {\n    const { indicatorRotation, dragProps } = useSheetContext();\n    const { constraintsRef, onMeasureDragConstraints } = useDragConstraints();\n    const _dragProps = disableDrag ? undefined : dragProps;\n\n    const indicator1Transform = useTransform(\n      indicatorRotation,\n      r => `translateX(2px) rotate(${r}deg)`\n    );\n\n    const indicator2Transform = useTransform(\n      indicatorRotation,\n      r => `translateX(-2px) rotate(${-1 * r}deg)`\n    );\n\n    return (\n      <motion.div\n        {...rest}\n        ref={mergeRefs([ref, constraintsRef])}\n        style={{ ...styles.headerWrapper, ...style }}\n        {..._dragProps}\n        dragConstraints={constraintsRef}\n        onMeasureDragConstraints={onMeasureDragConstraints}\n      >\n        {children || (\n          <div className=\"react-modal-sheet-header\" style={styles.header}>\n            <motion.span\n              className=\"react-modal-sheet-drag-indicator\"\n              style={{ ...styles.indicator, transform: indicator1Transform }}\n            />\n            <motion.span\n              className=\"react-modal-sheet-drag-indicator\"\n              style={{ ...styles.indicator, transform: indicator2Transform }}\n            />\n          </div>\n        )}\n      </motion.div>\n    );\n  }\n);\n\nexport default SheetHeader;\n","import * as React from 'react';\nimport { motion } from 'framer-motion';\n\nimport { SheetBackdropProps } from './types';\nimport styles from './styles';\n\nconst isClickable = (props: any) => !!props.onClick || !!props.onTap;\n\nconst SheetBackdrop = React.forwardRef<any, SheetBackdropProps>(\n  ({ style = {}, className = '', ...rest }, ref) => {\n    const Comp = isClickable(rest) ? motion.button : motion.div;\n    const pointerEvents = isClickable(rest) ? 'auto' : 'none';\n\n    return (\n      <Comp\n        {...rest}\n        ref={ref}\n        className={`react-modal-sheet-backdrop ${className}`}\n        style={{ ...styles.backdrop, ...style, pointerEvents }}\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n      />\n    );\n  }\n);\n\nexport default SheetBackdrop;\n","import * as React from 'react';\n\nimport { useSheetScrollerContext } from './context';\nimport { SheetScrollerProps } from './types';\nimport { isTouchDevice } from './utils';\nimport styles from './styles';\n\nconst SheetScroller = React.forwardRef<any, SheetScrollerProps>(\n  ({ draggableAt = 'top', children, style, className = '', ...rest }, ref) => {\n    const sheetScrollerContext = useSheetScrollerContext();\n\n    function determineDragState(element: HTMLDivElement) {\n      const { scrollTop, scrollHeight, clientHeight } = element;\n      const isScrollable = scrollHeight > clientHeight;\n\n      if (!isScrollable) return;\n\n      const isAtTop = scrollTop <= 0;\n      const isAtBottom = scrollHeight - scrollTop === clientHeight;\n\n      const shouldEnable =\n        (draggableAt === 'top' && isAtTop) ||\n        (draggableAt === 'bottom' && isAtBottom) ||\n        (draggableAt === 'both' && (isAtTop || isAtBottom));\n\n      if (shouldEnable) {\n        sheetScrollerContext.setDragEnabled();\n      } else {\n        sheetScrollerContext.setDragDisabled();\n      }\n    }\n\n    function onScroll(e: React.UIEvent<HTMLDivElement>) {\n      determineDragState(e.currentTarget);\n    }\n\n    function onTouchStart(e: React.TouchEvent<HTMLDivElement>) {\n      determineDragState(e.currentTarget);\n    }\n\n    const scrollProps = isTouchDevice()\n      ? { onScroll, onTouchStart }\n      : undefined;\n\n    return (\n      <div\n        {...rest}\n        ref={ref}\n        className={`react-modal-sheet-scroller ${className}`}\n        style={{ ...styles.scroller, ...style }}\n        {...scrollProps}\n      >\n        {children}\n      </div>\n    );\n  }\n);\n\nexport default SheetScroller;\n","import { MotionValue } from 'framer-motion';\n\nimport Sheet from './sheet';\nimport SheetContainer from './SheetContainer';\nimport SheetContent from './SheetContent';\nimport SheetHeader from './SheetHeader';\nimport SheetBackdrop from './SheetBackdrop';\nimport SheetScroller from './SheetScroller';\nimport { SheetCompound } from './types';\n\nexport type SheetRef = {\n  y: MotionValue<number>;\n  snapTo: (index: number) => void;\n};\n\n// HACK: this is needed to get the typing to work properly...\nconst _SheetCompound: any = Sheet;\n_SheetCompound.Container = SheetContainer;\n_SheetCompound.Header = SheetHeader;\n_SheetCompound.Content = SheetContent;\n_SheetCompound.Backdrop = SheetBackdrop;\n_SheetCompound.Scroller = SheetScroller;\n\nexport default _SheetCompound as SheetCompound;\n"],"names":["MAX_HEIGHT","IS_SSR","window","DEFAULT_TWEEN_CONFIG","ease","duration","REDUCED_MOTION_TWEEN_CONFIG","DRAG_CLOSE_THRESHOLD","DRAG_VELOCITY_THRESHOLD","getClosest","nums","goal","closest","minDifference","Math","abs","i","length","difference","applyRootStyles","rootId","body","document","querySelector","root","p","h","innerHeight","s","style","backgroundColor","overflow","willChange","transition","transform","borderTopRightRadius","borderTopLeftRadius","cleanupRootStyles","getElementById","onTransitionEnd","removeProperty","removeEventListener","addEventListener","inDescendingOrder","arr","validateSnapTo","_ref","snapTo","sheetHeight","console","warn","max","round","mergeRefs","refs","value","forEach","ref","current","isTouchDevice","navigator","maxTouchPoints","useIsomorphicLayoutEffect","React","useModalEffect","isOpen","prevOpen","usePrevious","useEventCallbacks","callbacks","didOpen","handleAnimationComplete","onOpenEnd","onCloseEnd","onOpenStart","onCloseStart","useWindowHeight","_React$useState","windowHeight","setWindowHeight","updateHeight","state","useEvent","handler","handlerRef","fn","_len","arguments","args","Array","_key","apply","constraints","bottom","top","left","right","useDragConstraints","constraintsRef","onMeasureDragConstraints","SheetContext","undefined","useSheetContext","context","Error","SheetScrollerContext","SheetScrollerContextProvider","children","sheetContext","disableDrag","setDisableDrag","setDragEnabled","setDragDisabled","Provider","useSheetScrollerContext","visualViewport","nonTextInputTypes","Set","preventScrollCount","restore","usePreventScroll","options","_options","isDisabled","useLayoutEffect","isIOS","preventScrollMobileSafari","preventScrollStandard","chain","setStyle","documentElement","innerWidth","clientWidth","scrollable","lastY","onTouchStart","e","getScrollParent","target","changedTouches","pageY","onTouchMove","preventDefault","y","scrollTop","scrollHeight","clientHeight","onTouchEnd","willOpenKeyboard","activeElement","focus","requestAnimationFrame","onFocus","height","scrollIntoView","once","onWindowScroll","scrollTo","scrollX","pageXOffset","scrollY","pageYOffset","restoreStyles","removeEvents","addEvent","passive","capture","element","cur","event","scrollingElement","scrollableTop","getBoundingClientRect","targetTop","parentElement","HTMLInputElement","has","type","HTMLTextAreaElement","HTMLElement","isContentEditable","styles","wrapper","position","pointerEvents","backdrop","zIndex","width","touchAction","border","container","boxShadow","display","flexDirection","headerWrapper","header","alignItems","justifyContent","indicator","borderRadius","content","flexGrow","minHeight","scroller","overflowY","Sheet","onClose","onSnap","_ref$disableScrollLoc","disableScrollLocking","snapPoints","mountPoint","_ref$detent","detent","_ref$initialSnap","initialSnap","_ref$disableDrag","_ref$prefersReducedMo","prefersReducedMotion","_ref$tweenConfig","tweenConfig","rest","_objectWithoutPropertiesLoose","_excluded","sheetRef","indicatorRotation","useMotionValue","shouldReduceMotion","useReducedMotion","reduceMotion","Boolean","animationOptions","_extends","useTransform","visibility","map","point","assert","onDrag","_","_ref2","delta","velocity","getVelocity","set","get","onDragEnd","_ref3","sheetEl","currentY","snapToValues","min","includes","unshift","animate","snapValue","snapIndex","indexOf","roundedSheetHeight","shouldClose","snapPoint","dragProps","drag","dragElastic","dragMomentum","dragPropagation","sheet","motion","div","AnimatePresence","child","key","ReactDOM","SheetContainer","_ref$style","_ref$className","className","_useSheetContext","_useSheetContext$init","_useEventCallbacks","initialY","maxSnapHeight","maxHeight","initial","exit","onAnimationComplete","SheetContent","sheetScrollerContext","_useDragConstraints","dragConstraints","SheetHeader","_dragProps","indicator1Transform","r","indicator2Transform","span","isClickable","props","onClick","onTap","SheetBackdrop","Comp","button","opacity","SheetScroller","draggableAt","_ref$draggableAt","determineDragState","isScrollable","isAtTop","isAtBottom","shouldEnable","onScroll","currentTarget","scrollProps","_SheetCompound","Container","Header","Content","Backdrop","Scroller"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAO,IAAMA,UAAU,GAAG,8CAA8C;AAEjE,IAAMC,MAAM,GAAG,OAAOC,MAAM,KAAK,WAAW;AAE5C,IAAMC,oBAAoB,GAAG;EAClCC,IAAI,EAAE,SAAS;EACfC,QAAQ,EAAE;CACX;AAEM,IAAMC,2BAA2B,GAAG;EACzCF,IAAI,EAAE,QAAQ;EACdC,QAAQ,EAAE;CACX;AAEM,IAAME,oBAAoB,GAAG,GAAG;AAEhC,IAAMC,uBAAuB,GAAG,GAAG;;SCd1BC,UAAUA,CAACC,IAAc,EAAEC,IAAY;EACrD,IAAIC,OAAO,GAAGF,IAAI,CAAC,CAAC,CAAC;EACrB,IAAIG,aAAa,GAAGC,IAAI,CAACC,GAAG,CAACL,IAAI,CAAC,CAAC,CAAC,GAAGC,IAAI,CAAC;EAE5C,KAAK,IAAIK,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGN,IAAI,CAACO,MAAM,EAAED,CAAC,EAAE,EAAE;IACpC,IAAME,UAAU,GAAGJ,IAAI,CAACC,GAAG,CAACL,IAAI,CAACM,CAAC,CAAC,GAAGL,IAAI,CAAC;IAC3C,IAAIO,UAAU,GAAGL,aAAa,EAAE;MAC9BD,OAAO,GAAGF,IAAI,CAACM,CAAC,CAAC;MACjBH,aAAa,GAAGK,UAAU;;;EAI9B,OAAON,OAAO;AAChB;AAEA,SAAgBO,eAAeA,CAACC,MAAc;EAC5C,IAAMC,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAoB;EAC9D,IAAMC,IAAI,GAAGF,QAAQ,CAACC,aAAa,OAAKH,MAAQ,CAAmB;EAEnE,IAAII,IAAI,EAAE;IACR,IAAMC,CAAC,GAAG,EAAE;IACZ,IAAMC,CAAC,GAAGxB,MAAM,CAACyB,WAAW;IAC5B,IAAMC,CAAC,GAAG,CAACF,CAAC,GAAGD,CAAC,IAAIC,CAAC;IACrBL,IAAI,CAACQ,KAAK,CAACC,eAAe,GAAG,MAAM;IACnCN,IAAI,CAACK,KAAK,CAACE,QAAQ,GAAG,QAAQ;IAC9BP,IAAI,CAACK,KAAK,CAACG,UAAU,GAAG,WAAW;IACnCR,IAAI,CAACK,KAAK,CAACI,UAAU,GACnB,yDAAyD;IAC3DT,IAAI,CAACK,KAAK,CAACK,SAAS,mDAAiDT,CAAC,GAAG,CAAC,mBAAcG,CAAC,MAAG,CAAC;IAC7FJ,IAAI,CAACK,KAAK,CAACM,oBAAoB,GAAG,MAAM;IACxCX,IAAI,CAACK,KAAK,CAACO,mBAAmB,GAAG,MAAM;;AAE3C;AAEA,SAAgBC,iBAAiBA,CAACjB,MAAc;EAC9C,IAAMC,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAoB;EAC9D,IAAMC,IAAI,GAAGF,QAAQ,CAACgB,cAAc,CAAClB,MAAM,CAAmB;EAE9D,SAASmB,eAAeA;IACtBf,IAAI,CAACK,KAAK,CAACW,cAAc,CAAC,UAAU,CAAC;IACrChB,IAAI,CAACK,KAAK,CAACW,cAAc,CAAC,aAAa,CAAC;IACxChB,IAAI,CAACK,KAAK,CAACW,cAAc,CAAC,YAAY,CAAC;IACvCnB,IAAI,CAACQ,KAAK,CAACW,cAAc,CAAC,kBAAkB,CAAC;IAC7ChB,IAAI,CAACiB,mBAAmB,CAAC,eAAe,EAAEF,eAAe,CAAC;;EAG5D,IAAIf,IAAI,EAAE;;IAERA,IAAI,CAACK,KAAK,CAACW,cAAc,CAAC,yBAAyB,CAAC;IACpDhB,IAAI,CAACK,KAAK,CAACW,cAAc,CAAC,wBAAwB,CAAC;IACnDhB,IAAI,CAACK,KAAK,CAACW,cAAc,CAAC,WAAW,CAAC;;IAGtChB,IAAI,CAACkB,gBAAgB,CAAC,eAAe,EAAEH,eAAe,CAAC;;AAE3D;AAEA,SAAgBI,iBAAiBA,CAACC,GAAa;EAC7C,KAAK,IAAI5B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG4B,GAAG,CAAC3B,MAAM,EAAED,CAAC,EAAE,EAAE;IACnC,IAAI4B,GAAG,CAAC5B,CAAC,GAAG,CAAC,CAAC,GAAG4B,GAAG,CAAC5B,CAAC,CAAC,EAAE,OAAO,KAAK;;EAGvC,OAAO,IAAI;AACb;AAEA,SAAgB6B,cAAcA,CAAAC,IAAA;MAC5BC,MAAM,GAAAD,IAAA,CAANC,MAAM;IACNC,WAAW,GAAAF,IAAA,CAAXE,WAAW;EAKX,IAAID,MAAM,GAAG,CAAC,EAAE;IACdE,OAAO,CAACC,IAAI,mDACsCF,WAAW,4BAAsBA,WAAW,GAC1FlC,IAAI,CAACC,GAAG,CAACgC,MAAM,CAAC,OAAG,CACtB;;EAGH,OAAOjC,IAAI,CAACqC,GAAG,CAACrC,IAAI,CAACsC,KAAK,CAACL,MAAM,CAAC,EAAE,CAAC,CAAC;AACxC;AAEA,SAAgBM,SAASA,CACvBC,IAA6B;EAE7B,OAAO,UAACC,KAAU;IAChBD,IAAI,CAACE,OAAO,CAAC,UAACC,GAAQ;MACpB,IAAI,OAAOA,GAAG,KAAK,UAAU,EAAE;QAC7BA,GAAG,CAACF,KAAK,CAAC;OACX,MAAM,IAAIE,GAAG,EAAE;QACdA,GAAG,CAACC,OAAO,GAAGH,KAAK;;KAEtB,CAAC;GACH;AACH;AAEA,SAAgBI,aAAaA;EAC3B,IAAI,OAAOzD,MAAM,KAAK,WAAW,EAAE,OAAO,KAAK;EAC/C,OAAO,cAAc,IAAIA,MAAM,IAAI0D,SAAS,CAACC,cAAc,GAAG,CAAC;AACjE;;AC9FO,IAAMC,yBAAyB,GAAG7D,MAAM,GAC3C8D,eAAe,GACfA,qBAAqB;AAEzB,SAAgBC,cAAcA,CAACC,MAAe,EAAE7C,MAAe;EAC7D,IAAM8C,QAAQ,GAAGC,WAAW,CAACF,MAAM,CAAC;;EAGpCF,eAAe,CAAC;IACd,IAAI3C,MAAM,IAAI,CAAC8C,QAAQ,IAAID,MAAM,EAAE;MACjC9C,eAAe,CAACC,MAAM,CAAC;KACxB,MAAM,IAAIA,MAAM,IAAI,CAAC6C,MAAM,IAAIC,QAAQ,EAAE;MACxC7B,iBAAiB,CAACjB,MAAM,CAAC;;GAE5B,EAAE,CAAC6C,MAAM,EAAEC,QAAQ,CAAC,CAAC,CAAC;;EAGvBH,eAAe,CAAC;IACd,OAAO;MACL,IAAI3C,MAAM,IAAI6C,MAAM,EAAE5B,iBAAiB,CAACjB,MAAM,CAAC;KAChD;GACF,EAAE,CAAC6C,MAAM,CAAC,CAAC,CAAC;AACf;;AAEA,SAAgBG,iBAAiBA,CAC/BH,MAAe,EACfI,SAA8C;EAE9C,IAAMH,QAAQ,GAAGC,WAAW,CAACF,MAAM,CAAC;EACpC,IAAMK,OAAO,GAAGP,YAAY,CAAC,KAAK,CAAC;;;;EAKnC,IAAMQ,uBAAuB,GAAGR,iBAAiB,CAAC;IAChD,IAAI,CAACO,OAAO,CAACZ,OAAO,EAAE;MACpBW,SAAS,CAACX,OAAO,CAACc,SAAS,YAA3BH,SAAS,CAACX,OAAO,CAACc,SAAS,EAAI;MAC/BF,OAAO,CAACZ,OAAO,GAAG,IAAI;KACvB,MAAM;MACLW,SAAS,CAACX,OAAO,CAACe,UAAU,YAA5BJ,SAAS,CAACX,OAAO,CAACe,UAAU,EAAI;MAChCH,OAAO,CAACZ,OAAO,GAAG,KAAK;;GAE1B,EAAE,CAACO,MAAM,EAAEC,QAAQ,CAAC,CAAC,CAAC;EAEvBH,eAAe,CAAC;IACd,IAAI,CAACG,QAAQ,IAAID,MAAM,EAAE;MACvBI,SAAS,CAACX,OAAO,CAACgB,WAAW,YAA7BL,SAAS,CAACX,OAAO,CAACgB,WAAW,EAAI;KAClC,MAAM,IAAI,CAACT,MAAM,IAAIC,QAAQ,EAAE;MAC9BG,SAAS,CAACX,OAAO,CAACiB,YAAY,YAA9BN,SAAS,CAACX,OAAO,CAACiB,YAAY,EAAI;;GAErC,EAAE,CAACV,MAAM,EAAEC,QAAQ,CAAC,CAAC,CAAC;EAEvB,OAAO;IAAEK,uBAAuB,EAAvBA;GAAyB;AACpC;AAEA,SAAgBK,eAAeA;EAC7B,IAAAC,eAAA,GAAwCd,cAAc,CAAC,CAAC,CAAC;IAAlDe,YAAY,GAAAD,eAAA;IAAEE,eAAe,GAAAF,eAAA;EAEpCf,yBAAyB,CAAC;IACxB,IAAMkB,YAAY,GAAG,SAAfA,YAAYA;MAAA,OAASD,eAAe,CAAC7E,MAAM,CAACyB,WAAW,CAAC;;IAC9DzB,MAAM,CAACwC,gBAAgB,CAAC,QAAQ,EAAEsC,YAAY,CAAC;IAC/CA,YAAY,EAAE;IACd,OAAO;MAAA,OAAM9E,MAAM,CAACuC,mBAAmB,CAAC,QAAQ,EAAEuC,YAAY,CAAC;;GAChE,EAAE,EAAE,CAAC;EAEN,OAAOF,YAAY;AACrB;AAEA,SAAgBX,WAAWA,CAAIc,KAAQ;EACrC,IAAMxB,GAAG,GAAGM,YAAY,EAAK;EAE7BA,eAAe,CAAC;IACdN,GAAG,CAACC,OAAO,GAAGuB,KAAK;GACpB,CAAC;EAEF,OAAOxB,GAAG,CAACC,OAAO;AACpB;AAEA;AACA;AACA,SAAgBwB,QAAQA,CAAoCC,OAAU;EACpE,IAAMC,UAAU,GAAGrB,YAAY,EAAK;EAEpCD,yBAAyB,CAAC;IACxBsB,UAAU,CAAC1B,OAAO,GAAGyB,OAAO;GAC7B,CAAC;EAEF,OAAOpB,iBAAiB,CAAC;IACvB,IAAMsB,EAAE,GAAGD,UAAU,CAAC1B,OAAO;IAAC,SAAA4B,IAAA,GAAAC,SAAA,CAAAtE,MAAA,EADHuE,IAAW,OAAAC,KAAA,CAAAH,IAAA,GAAAI,IAAA,MAAAA,IAAA,GAAAJ,IAAA,EAAAI,IAAA;MAAXF,IAAW,CAAAE,IAAA,IAAAH,SAAA,CAAAG,IAAA;;IAEtC,OAAOL,EAAE,oBAAFA,EAAE,CAAAM,KAAA,SAAMH,IAAI,CAAC;GACrB,EAAE,EAAE,CAAM;AACb;AAEA;AACA;AACA;AACA,IAAMI,WAAW,GAAgB;EAAEC,MAAM,EAAE,CAAC;EAAEC,GAAG,EAAE,CAAC;EAAEC,IAAI,EAAE,CAAC;EAAEC,KAAK,EAAE;CAAG;AAEzE,SAAgBC,kBAAkBA;EAChC,IAAMC,cAAc,GAAGnC,YAAY,CAAM,IAAI,CAAC;EAC9C,IAAMoC,wBAAwB,GAAGpC,iBAAiB,CAAC;IAAA,OAAM6B,WAAW;KAAE,EAAE,CAAC;EACzE,OAAO;IAAEM,cAAc,EAAdA,cAAc;IAAEC,wBAAwB,EAAxBA;GAA0B;AACrD;;AC1GO,IAAMC,YAAY,gBAAGrC,mBAAmB,CAC7CsC,SAAS,CACV;AAED,AAAO,IAAMC,eAAe,GAAG,SAAlBA,eAAeA;EAC1B,IAAMC,OAAO,GAAGxC,gBAAgB,CAACqC,YAAY,CAAC;EAC9C,IAAI,CAACG,OAAO,EAAE,MAAMC,KAAK,CAAC,qBAAqB,CAAC;EAChD,OAAOD,OAAO;AAChB,CAAC;AAED,AAAO,IAAME,oBAAoB,gBAAG1C,mBAAmB,CAErDsC,SAAS,CAAC;AAEZ,SAAgBK,4BAA4BA,CAAA5D,IAAA;MAC1C6D,QAAQ,GAAA7D,IAAA,CAAR6D,QAAQ;EAIR,IAAMC,YAAY,GAAGN,eAAe,EAAE;EACtC,IAAAzB,eAAA,GAAsCd,cAAc,CAClD,CAAC,CAAC6C,YAAY,CAACC,WAAW,CAC3B;IAFMA,WAAW,GAAAhC,eAAA;IAAEiC,cAAc,GAAAjC,eAAA;EAIlC,SAASkC,cAAcA;IACrB,IAAI,CAACH,YAAY,CAACC,WAAW,EAAEC,cAAc,CAAC,KAAK,CAAC;;EAGtD,SAASE,eAAeA;IACtB,IAAI,CAACH,WAAW,EAAEC,cAAc,CAAC,IAAI,CAAC;;EAGxC,OACE/C,oBAAC0C,oBAAoB,CAACQ,QAAQ;IAC5B1D,KAAK,EAAE;MAAEsD,WAAW,EAAXA,WAAW;MAAEE,cAAc,EAAdA,cAAc;MAAEC,eAAe,EAAfA;;KAErCL,QAAQ,CACqB;AAEpC;AAEA,AAAO,IAAMO,uBAAuB,GAAG,SAA1BA,uBAAuBA;EAClC,IAAMX,OAAO,GAAGxC,gBAAgB,CAAC0C,oBAAoB,CAAC;EACtD,IAAI,CAACF,OAAO,EAAE,MAAMC,KAAK,CAAC,8BAA8B,CAAC;EACzD,OAAOD,OAAO;AAChB,CAAC;;AChDD;AACA,AAYA;AACA,IAAMY,cAAc,GAAG,OAAOjH,MAAM,KAAK,WAAW,IAAIA,MAAM,CAACiH,cAAc;AAE7E;AACA,IAAMC,iBAAiB,gBAAG,IAAIC,GAAG,CAAC,CAChC,UAAU,EACV,OAAO,EACP,OAAO,EACP,OAAO,EACP,MAAM,EACN,OAAO,EACP,QAAQ,EACR,QAAQ,EACR,OAAO,CACR,CAAC;AAEF;AACA,IAAIC,kBAAkB,GAAG,CAAC;AAC1B,IAAIC,OAAY;AAEhB;;;;;AAKA,SAAgBC,gBAAgBA,CAACC;MAAAA;IAAAA,UAAgC,EAAE;;EACjE,IAAAC,QAAA,GAAqBD,OAAO;IAAtBE,UAAU,GAAAD,QAAA,CAAVC,UAAU;EAEhBC,qBAAe,CAAC;IACd,IAAID,UAAU,EAAE;MACd;;IAGFL,kBAAkB,EAAE;IACpB,IAAIA,kBAAkB,KAAK,CAAC,EAAE;MAC5B,IAAIO,WAAK,EAAE,EAAE;QACXN,OAAO,GAAGO,yBAAyB,EAAE;OACtC,MAAM;QACLP,OAAO,GAAGQ,qBAAqB,EAAE;;;IAIrC,OAAO;MACLT,kBAAkB,EAAE;MACpB,IAAIA,kBAAkB,KAAK,CAAC,EAAE;QAC5BC,OAAO,EAAE;;KAEZ;GACF,EAAE,CAACI,UAAU,CAAC,CAAC;AAClB;AAEA;AACA;AACA,SAASI,qBAAqBA;EAC5B,OAAOC,WAAK,CACVC,QAAQ,CACN3G,QAAQ,CAAC4G,eAAe,EACxB,cAAc,EACXhI,MAAM,CAACiI,UAAU,GAAG7G,QAAQ,CAAC4G,eAAe,CAACE,WAAW,OAAI,CAChE,EACDH,QAAQ,CAAC3G,QAAQ,CAAC4G,eAAe,EAAE,UAAU,EAAE,QAAQ,CAAC,CACzD;AACH;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASJ,yBAAyBA;EAChC,IAAIO,UAA+B;EACnC,IAAIC,KAAK,GAAG,CAAC;EACb,IAAIC,YAAY,GAAG,SAAfA,YAAYA,CAAIC,CAAa;;IAE/BH,UAAU,GAAGI,qBAAe,CAACD,CAAC,CAACE,MAAiB,CAAC;IACjD,IACEL,UAAU,KAAK/G,QAAQ,CAAC4G,eAAe,IACvCG,UAAU,KAAK/G,QAAQ,CAACD,IAAI,EAC5B;MACA;;IAGFiH,KAAK,GAAGE,CAAC,CAACG,cAAc,CAAC,CAAC,CAAC,CAACC,KAAK;GAClC;EAED,IAAIC,WAAW,GAAG,SAAdA,WAAWA,CAAIL,CAAa;;;;IAI9B,IAAIH,UAAU,KAAKhC,SAAS,EAAE;MAC5B;;;IAIF,IACEgC,UAAU,KAAK/G,QAAQ,CAAC4G,eAAe,IACvCG,UAAU,KAAK/G,QAAQ,CAACD,IAAI,EAC5B;MACAmH,CAAC,CAACM,cAAc,EAAE;MAClB;;;;;;IAOF,IAAIC,CAAC,GAAGP,CAAC,CAACG,cAAc,CAAC,CAAC,CAAC,CAACC,KAAK;IACjC,IAAII,SAAS,GAAGX,UAAU,CAACW,SAAS;IACpC,IAAInD,MAAM,GAAGwC,UAAU,CAACY,YAAY,GAAGZ,UAAU,CAACa,YAAY;;IAG9D,IAAIrD,MAAM,KAAK,CAAC,EAAE;MAChB;;IAGF,IAAKmD,SAAS,IAAI,CAAC,IAAID,CAAC,GAAGT,KAAK,IAAMU,SAAS,IAAInD,MAAM,IAAIkD,CAAC,GAAGT,KAAM,EAAE;MACvEE,CAAC,CAACM,cAAc,EAAE;;IAGpBR,KAAK,GAAGS,CAAC;GACV;EAED,IAAII,UAAU,GAAG,SAAbA,UAAUA,CAAIX,CAAa;IAC7B,IAAIE,MAAM,GAAGF,CAAC,CAACE,MAAqB;;IAGpC,IAAIU,gBAAgB,CAACV,MAAM,CAAC,IAAIA,MAAM,KAAKpH,QAAQ,CAAC+H,aAAa,EAAE;MACjEb,CAAC,CAACM,cAAc,EAAE;;;;MAKlBJ,MAAM,CAAC7G,KAAK,CAACK,SAAS,GAAG,qBAAqB;MAC9CwG,MAAM,CAACY,KAAK,EAAE;MACdC,qBAAqB,CAAC;QACpBb,MAAM,CAAC7G,KAAK,CAACK,SAAS,GAAG,EAAE;OAC5B,CAAC;;GAEL;EAED,IAAIsH,OAAO,GAAG,SAAVA,OAAOA,CAAIhB,CAAa;IAC1B,IAAIE,MAAM,GAAGF,CAAC,CAACE,MAAqB;IACpC,IAAIU,gBAAgB,CAACV,MAAM,CAAC,EAAE;;;;;MAK5BA,MAAM,CAAC7G,KAAK,CAACK,SAAS,GAAG,qBAAqB;MAC9CqH,qBAAqB,CAAC;QACpBb,MAAM,CAAC7G,KAAK,CAACK,SAAS,GAAG,EAAE;;;QAI3B,IAAIiF,cAAc,EAAE;UAClB,IAAIA,cAAc,CAACsC,MAAM,GAAGvJ,MAAM,CAACyB,WAAW,EAAE;;;YAG9C4H,qBAAqB,CAAC;cACpBG,cAAc,CAAChB,MAAM,CAAC;aACvB,CAAC;WACH,MAAM;;;YAGLvB,cAAc,CAACzE,gBAAgB,CAC7B,QAAQ,EACR;cAAA,OAAMgH,cAAc,CAAChB,MAAM,CAAC;eAC5B;cAAEiB,IAAI,EAAE;aAAM,CACf;;;OAGN,CAAC;;GAEL;EAED,IAAIC,cAAc,GAAG,SAAjBA,cAAcA;;;IAGhB1J,MAAM,CAAC2J,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;GACtB;;;;EAKD,IAAIC,OAAO,GAAG5J,MAAM,CAAC6J,WAAW;EAChC,IAAIC,OAAO,GAAG9J,MAAM,CAAC+J,WAAW;EAEhC,IAAIC,aAAa,GAAGlC,WAAK,CACvBC,QAAQ,CACN3G,QAAQ,CAAC4G,eAAe,EACxB,cAAc,EACXhI,MAAM,CAACiI,UAAU,GAAG7G,QAAQ,CAAC4G,eAAe,CAACE,WAAW,OAAI,CAChE,EACDH,QAAQ,CAAC3G,QAAQ,CAAC4G,eAAe,EAAE,UAAU,EAAE,QAAQ,CAAC,EACxDD,QAAQ,CAAC3G,QAAQ,CAACD,IAAI,EAAE,WAAW,QAAM2I,OAAO,OAAI,CAAC,CACtD;;EAGD9J,MAAM,CAAC2J,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;EAErB,IAAIM,YAAY,GAAGnC,WAAK,CACtBoC,QAAQ,CAAC9I,QAAQ,EAAE,YAAY,EAAEiH,YAAY,EAAE;IAC7C8B,OAAO,EAAE,KAAK;IACdC,OAAO,EAAE;GACV,CAAC,EACFF,QAAQ,CAAC9I,QAAQ,EAAE,WAAW,EAAEuH,WAAW,EAAE;IAC3CwB,OAAO,EAAE,KAAK;IACdC,OAAO,EAAE;GACV,CAAC,EACFF,QAAQ,CAAC9I,QAAQ,EAAE,UAAU,EAAE6H,UAAU,EAAE;IACzCkB,OAAO,EAAE,KAAK;IACdC,OAAO,EAAE;GACV,CAAC,EACFF,QAAQ,CAAC9I,QAAQ,EAAE,OAAO,EAAEkI,OAAO,EAAE,IAAI,CAAC,EAC1CY,QAAQ,CAAClK,MAAM,EAAE,QAAQ,EAAE0J,cAAc,CAAC,CAC3C;EAED,OAAO;;IAELM,aAAa,EAAE;IACfC,YAAY,EAAE;IACdjK,MAAM,CAAC2J,QAAQ,CAACC,OAAO,EAAEE,OAAO,CAAC;GAClC;AACH;AAEA;AACA,SAAS/B,QAAQA,CAACsC,OAAY,EAAE1I,KAAa,EAAE0B,KAAa;EAC1D,IAAIiH,GAAG,GAAGD,OAAO,CAAC1I,KAAK,CAACA,KAAK,CAAC;EAC9B0I,OAAO,CAAC1I,KAAK,CAACA,KAAK,CAAC,GAAG0B,KAAK;EAE5B,OAAO;IACLgH,OAAO,CAAC1I,KAAK,CAACA,KAAK,CAAC,GAAG2I,GAAG;GAC3B;AACH;AAEA;AACA,SAASJ,QAAQA,CACf1B,MAAmB,EACnB+B,KAAQ,EACRtF,OAAoE,EACpEsC,OAA2C;EAE3CiB,MAAM,CAAChG,gBAAgB,CAAC+H,KAAK,EAAEtF,OAAc,EAAEsC,OAAO,CAAC;EACvD,OAAO;IACLiB,MAAM,CAACjG,mBAAmB,CAACgI,KAAK,EAAEtF,OAAc,EAAEsC,OAAO,CAAC;GAC3D;AACH;AAEA,SAASiC,cAAcA,CAAChB,MAAe;EACrC,IAAIlH,IAAI,GAAGF,QAAQ,CAACoJ,gBAAgB,IAAIpJ,QAAQ,CAAC4G,eAAe;EAChE,OAAOQ,MAAM,IAAIA,MAAM,KAAKlH,IAAI,EAAE;;IAEhC,IAAI6G,UAAU,GAAGI,qBAAe,CAACC,MAAM,CAAC;IACxC,IACEL,UAAU,KAAK/G,QAAQ,CAAC4G,eAAe,IACvCG,UAAU,KAAK/G,QAAQ,CAACD,IAAI,IAC5BgH,UAAU,KAAKK,MAAM,EACrB;MACA,IAAIiC,aAAa,GAAGtC,UAAU,CAACuC,qBAAqB,EAAE,CAAC9E,GAAG;MAC1D,IAAI+E,SAAS,GAAGnC,MAAM,CAACkC,qBAAqB,EAAE,CAAC9E,GAAG;MAClD,IAAI+E,SAAS,GAAGF,aAAa,GAAGjC,MAAM,CAACQ,YAAY,EAAE;QACnDb,UAAU,CAACW,SAAS,IAAI6B,SAAS,GAAGF,aAAa;;;IAIrDjC,MAAM,GAAGL,UAAU,CAACyC,aAAoB;;AAE5C;AAEA,SAAS1B,gBAAgBA,CAACV,MAAe;EACvC,OACGA,MAAM,YAAYqC,gBAAgB,IACjC,CAAC3D,iBAAiB,CAAC4D,GAAG,CAACtC,MAAM,CAACuC,IAAI,CAAC,IACrCvC,MAAM,YAAYwC,mBAAmB,IACpCxC,MAAM,YAAYyC,WAAW,IAAIzC,MAAM,CAAC0C,iBAAkB;AAE/D;;ACnTA,IAAMC,MAAM,GAAsC;EAChDC,OAAO,EAAE;IACPC,QAAQ,EAAE,OAAO;IACjBzF,GAAG,EAAE,CAAC;IACND,MAAM,EAAE,CAAC;IACTE,IAAI,EAAE,CAAC;IACPC,KAAK,EAAE,CAAC;IACRjE,QAAQ,EAAE,QAAQ;IAClByJ,aAAa,EAAE;GAChB;EACDC,QAAQ,EAAE;IACRC,MAAM,EAAE,CAAC;IACTH,QAAQ,EAAE,OAAO;IACjBzF,GAAG,EAAE,CAAC;IACNC,IAAI,EAAE,CAAC;IACP4F,KAAK,EAAE,MAAM;IACblC,MAAM,EAAE,MAAM;IACd3H,eAAe,EAAE,oBAAoB;IACrC8J,WAAW,EAAE,MAAM;IACnBC,MAAM,EAAE;GACT;EACDC,SAAS,EAAE;IACTJ,MAAM,EAAE,CAAC;IACTH,QAAQ,EAAE,UAAU;IACpBxF,IAAI,EAAE,CAAC;IACPF,MAAM,EAAE,CAAC;IACT8F,KAAK,EAAE,MAAM;IACb7J,eAAe,EAAE,MAAM;IACvBK,oBAAoB,EAAE,KAAK;IAC3BC,mBAAmB,EAAE,KAAK;IAC1B2J,SAAS,EAAE,kCAAkC;IAC7CC,OAAO,EAAE,MAAM;IACfC,aAAa,EAAE,QAAQ;IACvBT,aAAa,EAAE;GAChB;EACDU,aAAa,EAAE;IACbP,KAAK,EAAE;GACR;EACDQ,MAAM,EAAE;IACN1C,MAAM,EAAE,MAAM;IACdkC,KAAK,EAAE,MAAM;IACbJ,QAAQ,EAAE,UAAU;IACpBS,OAAO,EAAE,MAAM;IACfI,UAAU,EAAE,QAAQ;IACpBC,cAAc,EAAE;GACjB;EACDC,SAAS,EAAE;IACTX,KAAK,EAAE,MAAM;IACblC,MAAM,EAAE,KAAK;IACb8C,YAAY,EAAE,MAAM;IACpBzK,eAAe,EAAE;GAClB;EACD0K,OAAO,EAAE;IACPC,QAAQ,EAAE,CAAC;IACXT,OAAO,EAAE,MAAM;IACfC,aAAa,EAAE,QAAQ;IACvBS,SAAS,EAAE,KAAK;IAChBnB,QAAQ,EAAE;GACX;EACDoB,QAAQ,EAAE;IACRlD,MAAM,EAAE,MAAM;IACdmD,SAAS,EAAE;;CAEd;;;ACjED,AAmCA,IAAMC,KAAK,gBAAG9I,gBAAgB,CAC5B,UAAAjB,IAAA,EAsBEW,GAAG;MApBDiB,WAAW,GAAA5B,IAAA,CAAX4B,WAAW;IACXF,SAAS,GAAA1B,IAAA,CAAT0B,SAAS;IACTsI,OAAO,GAAAhK,IAAA,CAAPgK,OAAO;IACPnI,YAAY,GAAA7B,IAAA,CAAZ6B,YAAY;IACZF,UAAU,GAAA3B,IAAA,CAAV2B,UAAU;IACVsI,MAAM,GAAAjK,IAAA,CAANiK,MAAM;IACNpG,QAAQ,GAAA7D,IAAA,CAAR6D,QAAQ;IAAAqG,qBAAA,GAAAlK,IAAA,CACRmK,oBAAoB;IAApBA,oBAAoB,GAAAD,qBAAA,cAAG,KAAK,GAAAA,qBAAA;IAC5B/I,MAAM,GAAAnB,IAAA,CAANmB,MAAM;IACNiJ,UAAU,GAAApK,IAAA,CAAVoK,UAAU;IACV9L,MAAM,GAAA0B,IAAA,CAAN1B,MAAM;IACN+L,UAAU,GAAArK,IAAA,CAAVqK,UAAU;IACVtL,KAAK,GAAAiB,IAAA,CAALjB,KAAK;IAAAuL,WAAA,GAAAtK,IAAA,CACLuK,MAAM;IAANA,MAAM,GAAAD,WAAA,cAAG,aAAa,GAAAA,WAAA;IAAAE,gBAAA,GAAAxK,IAAA,CACtByK,WAAW;IAAXA,WAAW,GAAAD,gBAAA,cAAG,CAAC,GAAAA,gBAAA;IAAAE,gBAAA,GAAA1K,IAAA,CACf+D,WAAW;IAAXA,WAAW,GAAA2G,gBAAA,cAAG,KAAK,GAAAA,gBAAA;IAAAC,qBAAA,GAAA3K,IAAA,CACnB4K,oBAAoB;IAApBA,oBAAoB,GAAAD,qBAAA,cAAG,KAAK,GAAAA,qBAAA;IAAAE,gBAAA,GAAA7K,IAAA,CAC5B8K,WAAW;IAAXA,WAAW,GAAAD,gBAAA,cAAGxN,oBAAoB,GAAAwN,gBAAA;IAC/BE,IAAI,GAAAC,6BAAA,CAAAhL,IAAA,EAAAiL,SAAA;EAIT,IAAMC,QAAQ,GAAGjK,YAAY,CAAM,IAAI,CAAC;EACxC,IAAMkK,iBAAiB,GAAGC,2BAAc,CAAC,CAAC,CAAC;EAC3C,IAAMpJ,YAAY,GAAGF,eAAe,EAAE;EACtC,IAAMuJ,kBAAkB,GAAGC,6BAAgB,EAAE;EAC7C,IAAMC,YAAY,GAAGC,OAAO,CAACZ,oBAAoB,IAAIS,kBAAkB,CAAC;EACxE,IAAMI,gBAAgB,GAAAC,QAAA;IACpBvD,IAAI,EAAE;KACFoD,YAAY,GAAG/N,2BAA2B,GAAGsN,WAAW,CAC7D;;;;EAKD,IAAM7E,CAAC,GAAGmF,2BAAc,CAAC,CAAC,CAAC;EAE3B,IAAMxC,MAAM,GAAG+C,yBAAY,CAAC1F,CAAC,EAAE,UAAAxF,KAAK;IAAA,OAClCA,KAAK,IAAIuB,YAAY,GAAG,CAAC,CAAC,GAAG,OAAO;IACrC;EAED,IAAM4J,UAAU,GAAGD,yBAAY,CAAC1F,CAAC,EAAE,UAAAxF,KAAK;IAAA,OACtCA,KAAK,IAAIuB,YAAY,GAAG,QAAQ,GAAG,SAAS;IAC7C;;;EAID,IAAMT,SAAS,GAAGN,YAAY,CAAC;IAC7BW,WAAW,EAAXA,WAAW;IACXF,SAAS,EAATA,SAAS;IACTG,YAAY,EAAZA,YAAY;IACZF,UAAU,EAAVA;GACD,CAAC;EAEFX,yBAAyB,CAAC;IACxBO,SAAS,CAACX,OAAO,GAAG;MAClBgB,WAAW,EAAXA,WAAW;MACXF,SAAS,EAATA,SAAS;MACTG,YAAY,EAAZA,YAAY;MACZF,UAAU,EAAVA;KACD;GACF,CAAC;EAEF,IAAIyI,UAAU,EAAE;;IAEdA,UAAU,GAAGA,UAAU,CAACyB,GAAG,CAAC,UAAAC,KAAK;;MAE/B,IAAIA,KAAK,GAAG,CAAC,IAAIA,KAAK,IAAI,CAAC,EAAE,OAAO9N,IAAI,CAACsC,KAAK,CAACwL,KAAK,GAAG9J,YAAY,CAAC;MACpE,OAAO8J,KAAK,GAAG,CAAC,GAAG9J,YAAY,GAAG8J,KAAK,GAAGA,KAAK,CAAC;KACjD,CAAC;;IAEF3L,OAAO,CAAC4L,MAAM,CACZlM,iBAAiB,CAACuK,UAAU,CAAC,IAAIpI,YAAY,KAAK,CAAC,wDACCoI,UAAU,MAAG,CAClE;;EAGH,IAAM4B,MAAM,GAAG5J,QAAQ,CAAC,UAAC6J,CAAC,EAAAC,KAAA;QAAIC,KAAK,GAAAD,KAAA,CAALC,KAAK;;IAEjC,IAAMC,QAAQ,GAAGnG,CAAC,CAACoG,WAAW,EAAE;IAEhC,IAAID,QAAQ,GAAG,CAAC,EAAEjB,iBAAiB,CAACmB,GAAG,CAAC,EAAE,CAAC;IAC3C,IAAIF,QAAQ,GAAG,CAAC,EAAEjB,iBAAiB,CAACmB,GAAG,CAAC,CAAC,EAAE,CAAC;;IAG5CrG,CAAC,CAACqG,GAAG,CAACtO,IAAI,CAACqC,GAAG,CAAC4F,CAAC,CAACsG,GAAG,EAAE,GAAGJ,KAAK,CAAClG,CAAC,EAAE,CAAC,CAAC,CAAC;GACtC,CAAC;EAEF,IAAMuG,SAAS,GAAGpK,QAAQ,CAAC,UAAC6J,CAAC,EAAAQ,KAAA;QAAIL,QAAQ,GAAAK,KAAA,CAARL,QAAQ;IACvC,IAAIA,QAAQ,CAACnG,CAAC,GAAGvI,uBAAuB,EAAE;;MAExCsM,OAAO,EAAE;KACV,MAAM;MACL,IAAM0C,OAAO,GAAGxB,QAAQ,CAACtK,OAAyB;MAClD,IAAMV,WAAW,GAAGwM,OAAO,CAAC5E,qBAAqB,EAAE,CAACnB,MAAM;MAC1D,IAAMgG,QAAQ,GAAG1G,CAAC,CAACsG,GAAG,EAAE;MAExB,IAAItM,MAAM,GAAG,CAAC;MAEd,IAAImK,UAAU,EAAE;QACd,IAAMwC,YAAY,GAAGxC,UAAU,CAACyB,GAAG,CACjC,UAAAlN,CAAC;UAAA,OAAIuB,WAAW,GAAGlC,IAAI,CAAC6O,GAAG,CAAClO,CAAC,EAAEuB,WAAW,CAAC;UAC5C;;QAGD,IAAIqK,MAAM,KAAK,gBAAgB,IAAI,CAACqC,YAAY,CAACE,QAAQ,CAAC,CAAC,CAAC,EAAE;UAC5DF,YAAY,CAACG,OAAO,CAAC,CAAC,CAAC;;;QAIzB9M,MAAM,GAAGtC,UAAU,CAACiP,YAAY,EAAED,QAAQ,CAAC;OAC5C,MAAM,IAAIA,QAAQ,GAAGzM,WAAW,GAAGzC,oBAAoB,EAAE;;QAExDwC,MAAM,GAAGC,WAAW;;MAGtBD,MAAM,GAAGF,cAAc,CAAC;QAAEE,MAAM,EAANA,MAAM;QAAEC,WAAW,EAAXA;OAAa,CAAC;;MAGhD8M,oBAAO,CAAC/G,CAAC,EAAEhG,MAAM,EAAEwL,gBAAgB,CAAC;MAEpC,IAAIrB,UAAU,IAAIH,MAAM,EAAE;QACxB,IAAMgD,SAAS,GAAGjP,IAAI,CAACC,GAAG,CAACD,IAAI,CAACsC,KAAK,CAAC8J,UAAU,CAAC,CAAC,CAAC,GAAGnK,MAAM,CAAC,CAAC;QAC9D,IAAMiN,SAAS,GAAG9C,UAAU,CAAC+C,OAAO,CAACxP,UAAU,CAACyM,UAAU,EAAE6C,SAAS,CAAC,CAAC,CAAC;QACxEhD,MAAM,CAACiD,SAAS,CAAC;;MAGnB,IAAME,kBAAkB,GAAGpP,IAAI,CAACsC,KAAK,CAACJ,WAAW,CAAC;MAClD,IAAMmN,WAAW,GAAGpN,MAAM,IAAImN,kBAAkB;MAEhD,IAAIC,WAAW,EAAErD,OAAO,EAAE;;;IAI5BmB,iBAAiB,CAACmB,GAAG,CAAC,CAAC,CAAC;GACzB,CAAC;;EAGFrL,eAAe,CAAC;IACd,IAAI,CAACmJ,UAAU,IAAI,CAACH,MAAM,EAAE;IAC5B,IAAMiD,SAAS,GAAG/L,MAAM,GAAGsJ,WAAW,GAAGL,UAAU,CAACjM,MAAM,GAAG,CAAC;IAC9D8L,MAAM,CAACiD,SAAS,CAAC;GAClB,EAAE,CAAC/L,MAAM,CAAC,CAAC,CAAC;EAEbF,yBAAyB,CAACN,GAAG,EAAE;IAAA,OAAO;MACpCsF,CAAC,EAADA,CAAC;MACDhG,MAAM,EAAE,SAAAA,OAACiN,SAAiB;QACxB,IAAMR,OAAO,GAAGxB,QAAQ,CAACtK,OAAgC;QAEzD,IACEwJ,UAAU,IACVA,UAAU,CAAC8C,SAAS,CAAC,KAAK3J,SAAS,IACnCmJ,OAAO,KAAK,IAAI,EAChB;UACA,IAAMxM,WAAW,GAAGwM,OAAO,CAAC5E,qBAAqB,EAAE,CAACnB,MAAM;UAC1D,IAAM2G,SAAS,GAAGlD,UAAU,CAAC8C,SAAS,CAAC;UACvC,IAAMjN,MAAM,GAAGF,cAAc,CAAC;YAC5BE,MAAM,EAAEC,WAAW,GAAGoN,SAAS;YAC/BpN,WAAW,EAAXA;WACD,CAAC;UAEF8M,oBAAO,CAAC/G,CAAC,EAAEhG,MAAM,EAAEwL,gBAAgB,CAAC;UACpC,IAAIxB,MAAM,EAAEA,MAAM,CAACiD,SAAS,CAAC;UAC7B,IAAIjN,MAAM,IAAIC,WAAW,EAAE8J,OAAO,EAAE;;;KAGzC;GAAC,CAAC;EAEH9I,cAAc,CAACC,MAAM,EAAE7C,MAAM,CAAC;;;EAI9BoG,gBAAgB,CAAC;IAAEG,UAAU,EAAEsF,oBAAoB,KAAK,IAAI,IAAI,CAAChJ;GAAQ,CAAC;EAE1E,IAAMoM,SAAS,GAAGtM,aAAa,CAAC;IAC9B,IAAMsM,SAAS,GAAkC;MAC/CC,IAAI,EAAE,GAAG;MACTC,WAAW,EAAE,CAAC;MACdC,YAAY,EAAE,KAAK;MACnBC,eAAe,EAAE,KAAK;MACtB3B,MAAM,EAANA,MAAM;MACNQ,SAAS,EAATA;KACD;IAED,OAAOzI,WAAW,GAAGR,SAAS,GAAGgK,SAAS;GAC3C,EAAE,CAACxJ,WAAW,CAAC,CAAC,CAAC;EAElB,IAAMN,OAAO,GAAqB;IAChCwC,CAAC,EAADA,CAAC;IACDiF,QAAQ,EAARA,QAAQ;IACR/J,MAAM,EAANA,MAAM;IACNsJ,WAAW,EAAXA,WAAW;IACXL,UAAU,EAAVA,UAAU;IACVG,MAAM,EAANA,MAAM;IACNY,iBAAiB,EAAjBA,iBAAiB;IACjB5J,SAAS,EAATA,SAAS;IACTgM,SAAS,EAATA,SAAS;IACTvL,YAAY,EAAZA,YAAY;IACZyJ,gBAAgB,EAAhBA,gBAAgB;IAChBF,YAAY,EAAZA,YAAY;IACZxH,WAAW,EAAXA;GACD;EAED,IAAM6J,KAAK,GACT3M,oBAACqC,YAAY,CAACa,QAAQ;IAAC1D,KAAK,EAAEgD;KAC5BxC,oBAAC4M,mBAAM,CAACC,GAAG,oBACL/C,IAAI;IACRpK,GAAG,EAAEA,GAAG;IACR5B,KAAK,EAAA2M,QAAA,KAAOnD,MAAM,CAACC,OAAO;MAAEI,MAAM,EAANA,MAAM;MAAEgD,UAAU,EAAVA;OAAe7M,KAAK;MAExDkC,oBAAC8M,4BAAe,QAEb5M,MAAM,GACLF,oBAAC2C,4BAA4B,QAC1B3C,cAAc,CAAC4K,GAAG,CAAChI,QAAQ,EAAE,UAACmK,KAAU,EAAE9P,CAAC;IAAA,OAC1C+C,kBAAkB,CAAC+M,KAAK,EAAE;MAAEC,GAAG,mBAAiB/P;KAAK,CAAC;IACvD,CAC4B,GAC7B,IAAI,CACQ,CACP,CAEhB;EAED,IAAIf,MAAM,EAAE,OAAOyQ,KAAK;EAExB,OAAOM,qBAAqB,CAACN,KAAK,EAAEvD,UAAU,WAAVA,UAAU,GAAI7L,QAAQ,CAACD,IAAI,CAAC;AAClE,CAAC,CACF;;;AC1QD,AAUA,IAAM4P,cAAc,gBAAGlN,gBAAgB,CACrC,UAAAjB,IAAA,EAAoDW,GAAG;MAApDkD,QAAQ,GAAA7D,IAAA,CAAR6D,QAAQ;IAAAuK,UAAA,GAAApO,IAAA,CAAEjB,KAAK;IAALA,KAAK,GAAAqP,UAAA,cAAG,EAAE,GAAAA,UAAA;IAAAC,cAAA,GAAArO,IAAA,CAAEsO,SAAS;IAATA,SAAS,GAAAD,cAAA,cAAG,EAAE,GAAAA,cAAA;IAAKtD,IAAI,GAAAC,6BAAA,CAAAhL,IAAA,EAAAiL,WAAA;EAC9C,IAAAsD,gBAAA,GAWI/K,eAAe,EAAE;IAVnByC,CAAC,GAAAsI,gBAAA,CAADtI,CAAC;IACD9E,MAAM,GAAAoN,gBAAA,CAANpN,MAAM;IACNI,SAAS,GAAAgN,gBAAA,CAAThN,SAAS;IACT6I,UAAU,GAAAmE,gBAAA,CAAVnE,UAAU;IAAAoE,qBAAA,GAAAD,gBAAA,CACV9D,WAAW;IAAXA,WAAW,GAAA+D,qBAAA,cAAG,CAAC,GAAAA,qBAAA;IACftD,QAAQ,GAAAqD,gBAAA,CAARrD,QAAQ;IACRlJ,YAAY,GAAAuM,gBAAA,CAAZvM,YAAY;IACZuI,MAAM,GAAAgE,gBAAA,CAANhE,MAAM;IACNkB,gBAAgB,GAAA8C,gBAAA,CAAhB9C,gBAAgB;IAChBF,YAAY,GAAAgD,gBAAA,CAAZhD,YAAY;EAGd,IAAAkD,kBAAA,GAAoCnN,iBAAiB,CAACH,MAAM,EAAEI,SAAS,CAAC;IAAhEE,uBAAuB,GAAAgN,kBAAA,CAAvBhN,uBAAuB;EAC/B,IAAMiN,QAAQ,GAAGtE,UAAU,GAAGA,UAAU,CAAC,CAAC,CAAC,GAAGA,UAAU,CAACK,WAAW,CAAC,GAAG,CAAC;EACzE,IAAMkE,aAAa,GAAGvE,UAAU,GAAGA,UAAU,CAAC,CAAC,CAAC,GAAG,IAAI;EAEvD,IAAMzD,MAAM,GACVgI,aAAa,KAAK,IAAI,YACXA,aAAa,YAAOzR,UAAU,SACrCA,UAAU;EAEhB,OACE+D,oBAAC4M,mBAAM,CAACC,GAAG,oBACL/C,IAAI;IACRpK,GAAG,EAAEJ,SAAS,CAAC,CAAC2K,QAAQ,EAAEvK,GAAG,CAAC,CAAC;IAC/B2N,SAAS,mCAAiCA,SAAW;IACrDvP,KAAK,EAAA2M,QAAA,KACAnD,MAAM,CAACS,SAAS,EAChBjK,KAAK,EACJwL,MAAM,KAAK,aAAa,IAAI;MAAE5D,MAAM,EAANA;KAAQ,EACtC4D,MAAM,KAAK,gBAAgB,IAAI;MAAEqE,SAAS,EAAEjI;KAAQ;MACxDV,CAAC,EAADA;MACD;IACD4I,OAAO,EAAEtD,YAAY,GAAG,KAAK,GAAG;MAAEtF,CAAC,EAAEjE;KAAc;IACnDgL,OAAO,EAAE;MAAE/G,CAAC,EAAEyI,QAAQ;MAAEvP,UAAU,EAAEsM;KAAkB;IACtDqD,IAAI,EAAE;MAAE7I,CAAC,EAAEjE,YAAY;MAAE7C,UAAU,EAAEsM;KAAkB;IACvDsD,mBAAmB,EAAEtN;MAEpBoC,QAAQ,CACE;AAEjB,CAAC,CACF;;;ACvDD,AASA,IAAMmL,YAAY,gBAAG/N,gBAAgB,CACnC,UAAAjB,IAAA,EAA4DW,GAAG;MAA5DkD,QAAQ,GAAA7D,IAAA,CAAR6D,QAAQ;IAAE9E,KAAK,GAAAiB,IAAA,CAALjB,KAAK;IAAEgF,WAAW,GAAA/D,IAAA,CAAX+D,WAAW;IAAAsK,cAAA,GAAArO,IAAA,CAAEsO,SAAS;IAATA,SAAS,GAAAD,cAAA,cAAG,EAAE,GAAAA,cAAA;IAAKtD,IAAI,GAAAC,6BAAA,CAAAhL,IAAA,EAAAiL,WAAA;EACtD,IAAMnH,YAAY,GAAGN,eAAe,EAAE;EACtC,IAAMyL,oBAAoB,GAAG7K,uBAAuB,EAAE;EACtD,IAAA8K,mBAAA,GAAqD/L,kBAAkB,EAAE;IAAjEC,cAAc,GAAA8L,mBAAA,CAAd9L,cAAc;IAAEC,wBAAwB,GAAA6L,mBAAA,CAAxB7L,wBAAwB;EAEhD,IAAMkK,SAAS,GACbxJ,WAAW,IAAIkL,oBAAoB,CAAClL,WAAW,GAC3CR,SAAS,GACTO,YAAY,CAACyJ,SAAS;EAE5B,OACEtM,oBAAC4M,mBAAM,CAACC,GAAG,oBACL/C,IAAI;IACRpK,GAAG,EAAEJ,SAAS,CAAC,CAACI,GAAG,EAAEyC,cAAc,CAAC,CAAC;IACrCkL,SAAS,iCAA+BA,SAAW;IACnDvP,KAAK,EAAA2M,QAAA,KAAOnD,MAAM,CAACmB,OAAO,EAAK3K,KAAK;KAChCwO,SAAS;IACb4B,eAAe,EAAE/L,cAAc;IAC/BC,wBAAwB,EAAEA;MAEzBQ,QAAQ,CACE;AAEjB,CAAC,CACF;;;AClCD,AASA,IAAMuL,WAAW,gBAAGnO,gBAAgB,CAClC,UAAAjB,IAAA,EAA4CW,GAAG;MAA5CkD,QAAQ,GAAA7D,IAAA,CAAR6D,QAAQ;IAAE9E,KAAK,GAAAiB,IAAA,CAALjB,KAAK;IAAEgF,WAAW,GAAA/D,IAAA,CAAX+D,WAAW;IAAKgH,IAAI,GAAAC,6BAAA,CAAAhL,IAAA,EAAAiL,WAAA;EACtC,IAAAsD,gBAAA,GAAyC/K,eAAe,EAAE;IAAlD2H,iBAAiB,GAAAoD,gBAAA,CAAjBpD,iBAAiB;IAAEoC,SAAS,GAAAgB,gBAAA,CAAThB,SAAS;EACpC,IAAA2B,mBAAA,GAAqD/L,kBAAkB,EAAE;IAAjEC,cAAc,GAAA8L,mBAAA,CAAd9L,cAAc;IAAEC,wBAAwB,GAAA6L,mBAAA,CAAxB7L,wBAAwB;EAChD,IAAMgM,UAAU,GAAGtL,WAAW,GAAGR,SAAS,GAAGgK,SAAS;EAEtD,IAAM+B,mBAAmB,GAAG3D,yBAAY,CACtCR,iBAAiB,EACjB,UAAAoE,CAAC;IAAA,mCAA8BA,CAAC;GAAM,CACvC;EAED,IAAMC,mBAAmB,GAAG7D,yBAAY,CACtCR,iBAAiB,EACjB,UAAAoE,CAAC;IAAA,oCAA+B,CAAC,CAAC,GAAGA,CAAC;GAAM,CAC7C;EAED,OACEtO,oBAAC4M,mBAAM,CAACC,GAAG,oBACL/C,IAAI;IACRpK,GAAG,EAAEJ,SAAS,CAAC,CAACI,GAAG,EAAEyC,cAAc,CAAC,CAAC;IACrCrE,KAAK,EAAA2M,QAAA,KAAOnD,MAAM,CAACa,aAAa,EAAKrK,KAAK;KACtCsQ,UAAU;IACdF,eAAe,EAAE/L,cAAc;IAC/BC,wBAAwB,EAAEA;MAEzBQ,QAAQ,IACP5C;IAAKqN,SAAS,EAAC,0BAA0B;IAACvP,KAAK,EAAEwJ,MAAM,CAACc;KACtDpI,oBAAC4M,mBAAM,CAAC4B,IAAI;IACVnB,SAAS,EAAC,kCAAkC;IAC5CvP,KAAK,EAAA2M,QAAA,KAAOnD,MAAM,CAACiB,SAAS;MAAEpK,SAAS,EAAEkQ;;IACzC,EACFrO,oBAAC4M,mBAAM,CAAC4B,IAAI;IACVnB,SAAS,EAAC,kCAAkC;IAC5CvP,KAAK,EAAA2M,QAAA,KAAOnD,MAAM,CAACiB,SAAS;MAAEpK,SAAS,EAAEoQ;;IACzC,CAEL,CACU;AAEjB,CAAC,CACF;;;ACjDD,AAMA,IAAME,WAAW,GAAG,SAAdA,WAAWA,CAAIC,KAAU;EAAA,OAAK,CAAC,CAACA,KAAK,CAACC,OAAO,IAAI,CAAC,CAACD,KAAK,CAACE,KAAK;AAAA;AAEpE,IAAMC,aAAa,gBAAG7O,gBAAgB,CACpC,UAAAjB,IAAA,EAA0CW,GAAG;wBAA1C5B,KAAK;IAALA,KAAK,GAAAqP,UAAA,cAAG,EAAE,GAAAA,UAAA;IAAAC,cAAA,GAAArO,IAAA,CAAEsO,SAAS;IAATA,SAAS,GAAAD,cAAA,cAAG,EAAE,GAAAA,cAAA;IAAKtD,IAAI,GAAAC,6BAAA,CAAAhL,IAAA,EAAAiL,WAAA;EACpC,IAAM8E,IAAI,GAAGL,WAAW,CAAC3E,IAAI,CAAC,GAAG8C,mBAAM,CAACmC,MAAM,GAAGnC,mBAAM,CAACC,GAAG;EAC3D,IAAMpF,aAAa,GAAGgH,WAAW,CAAC3E,IAAI,CAAC,GAAG,MAAM,GAAG,MAAM;EAEzD,OACE9J,oBAAC8O,IAAI,oBACChF,IAAI;IACRpK,GAAG,EAAEA,GAAG;IACR2N,SAAS,kCAAgCA,SAAW;IACpDvP,KAAK,EAAA2M,QAAA,KAAOnD,MAAM,CAACI,QAAQ,EAAK5J,KAAK;MAAE2J,aAAa,EAAbA;MAAe;IACtDmG,OAAO,EAAE;MAAEoB,OAAO,EAAE;KAAG;IACvBjD,OAAO,EAAE;MAAEiD,OAAO,EAAE;KAAG;IACvBnB,IAAI,EAAE;MAAEmB,OAAO,EAAE;;KACjB;AAEN,CAAC,CACF;;;ACzBD,AAOA,IAAMC,aAAa,gBAAGjP,gBAAgB,CACpC,UAAAjB,IAAA,EAAoEW,GAAG;8BAApEwP,WAAW;IAAXA,WAAW,GAAAC,gBAAA,cAAG,KAAK,GAAAA,gBAAA;IAAEvM,QAAQ,GAAA7D,IAAA,CAAR6D,QAAQ;IAAE9E,KAAK,GAAAiB,IAAA,CAALjB,KAAK;IAAAsP,cAAA,GAAArO,IAAA,CAAEsO,SAAS;IAATA,SAAS,GAAAD,cAAA,cAAG,EAAE,GAAAA,cAAA;IAAKtD,IAAI,GAAAC,6BAAA,CAAAhL,IAAA,EAAAiL,WAAA;EAC9D,IAAMgE,oBAAoB,GAAG7K,uBAAuB,EAAE;EAEtD,SAASiM,kBAAkBA,CAAC5I,OAAuB;IACjD,IAAQvB,SAAS,GAAiCuB,OAAO,CAAjDvB,SAAS;MAAEC,YAAY,GAAmBsB,OAAO,CAAtCtB,YAAY;MAAEC,YAAY,GAAKqB,OAAO,CAAxBrB,YAAY;IAC7C,IAAMkK,YAAY,GAAGnK,YAAY,GAAGC,YAAY;IAEhD,IAAI,CAACkK,YAAY,EAAE;IAEnB,IAAMC,OAAO,GAAGrK,SAAS,IAAI,CAAC;IAC9B,IAAMsK,UAAU,GAAGrK,YAAY,GAAGD,SAAS,KAAKE,YAAY;IAE5D,IAAMqK,YAAY,GACfN,WAAW,KAAK,KAAK,IAAII,OAAO,IAChCJ,WAAW,KAAK,QAAQ,IAAIK,UAAW,IACvCL,WAAW,KAAK,MAAM,KAAKI,OAAO,IAAIC,UAAU,CAAE;IAErD,IAAIC,YAAY,EAAE;MAChBxB,oBAAoB,CAAChL,cAAc,EAAE;KACtC,MAAM;MACLgL,oBAAoB,CAAC/K,eAAe,EAAE;;;EAI1C,SAASwM,QAAQA,CAAChL,CAAgC;IAChD2K,kBAAkB,CAAC3K,CAAC,CAACiL,aAAa,CAAC;;EAGrC,SAASlL,YAAYA,CAACC,CAAmC;IACvD2K,kBAAkB,CAAC3K,CAAC,CAACiL,aAAa,CAAC;;EAGrC,IAAMC,WAAW,GAAG/P,aAAa,EAAE,GAC/B;IAAE6P,QAAQ,EAARA,QAAQ;IAAEjL,YAAY,EAAZA;GAAc,GAC1BlC,SAAS;EAEb,OACEtC,6CACM8J,IAAI;IACRpK,GAAG,EAAEA,GAAG;IACR2N,SAAS,kCAAgCA,SAAW;IACpDvP,KAAK,EAAA2M,QAAA,KAAOnD,MAAM,CAACsB,QAAQ,EAAK9K,KAAK;KACjC6R,WAAW,GAEd/M,QAAQ,CACL;AAEV,CAAC,CACF;;ACzCD;AACA,IAAMgN,cAAc,GAAQ9G,KAAK;AACjC8G,cAAc,CAACC,SAAS,GAAG3C,cAAc;AACzC0C,cAAc,CAACE,MAAM,GAAG3B,WAAW;AACnCyB,cAAc,CAACG,OAAO,GAAGhC,YAAY;AACrC6B,cAAc,CAACI,QAAQ,GAAGnB,aAAa;AACvCe,cAAc,CAACK,QAAQ,GAAGhB,aAAa;;;;"}